<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <p>The appendix below describes how the Google Authentication scheme in this tutorial was set up, in advance of this tutorial.</p>

<h2 id="appendix-google-authentication-configuration-setup">Appendix - Google+  Authentication Configuration &amp; Setup</h2>

<p>The appendix below describes how to create an OAUTH2.0 authentication service for authenticating client applications. These steps at a high-level overview consist of:</p>

<ol>
<li>Create Google API+ Project</li>
<li>Create Credentials Service Account</li>
<li>Create OAuth2.0 Consent</li>
<li>Create OAuth2.0 Client ID credentials for the Credentials Service Account</li>
</ol>

<h2 class='everybody'>Step A1:  Create Google API+ Project </h2>

<ol>
<li><p>Login to your Google account - if you don&#39;t have one - create one at google.com and <strong>sign in to Google</strong></p></li>
<li><p>Link for the page <a href="https://console.developers.google.com/apis/">https://console.developers.google.com/apis/</a></p></li>
</ol>

<p>You should see the following page on arrival. Search for ‘Google+’ in the search bar and select the <strong>Google+</strong> APIs icon when presented.</p>

<p><img src="images/google/google_apis.png" alt="Google+ APIs"></p>

<ol>
<li><p>Once selected - click to Enable the Google+ APIs - it is important that you do this.</p></li>
<li><p>As you don’t have a &#39;project&#39; yet, you will be prompted to create a project as it is needed to enable the APIs. Click ‘Create Project’</p></li>
<li><p>You will be prompted to give it a name - call it &#39;GoogleAuth&#39; and <strong>take a note of the Project ID</strong> in our case it is shown as <code>proven-caster-195417</code> - this will be used later on.</p></li>
<li><p>After creating the project, you will be redirected to the Google+ API page again. You should now see the project name selected and the option to ‘Enable’ the service. Click ‘Enable’.</p></li>
</ol>

<h2 class='everybody'>Step A2:  Create Credentials Service Account  </h2>

<ol>
<li><p>Once you have enabled the service you will be prompted to create Service Account Credentials so that you can use the service.  Click ‘Create Credentials’.</p></li>
<li><p>You will be asked a series of questions to determine what kind of credentials you will need. Give the answers shown in the screenshot below. Choose &#39;Google+ API&#39;  for the API, Web Server (e.g. Node js, Tomcat) and Application data and &#39;No&#39; for the Engine question at the bottom.</p></li>
<li><p>Click on <code>What credentials do I need</code>  and hit Continue</p></li>
</ol>

<p><img src="images/google/setup_credentials.png" alt="Setup Credentials"></p>

<ol>
<li><p>Next, setup a Credentials service account - with the name &#39;GoogleAuthService&#39; - select &#39;Project&#39; in the dropdown and select a role of <code>Owner</code> and a type of JSON and</p></li>
<li><p>Click on &#39;Get your Credentials&#39; - it should download (or prompt to download) the service credentials in JSON format - save these to a safe location.</p></li>
</ol>

<p><img src="images/google/credentials_svc_acc.png" alt="Setup Credentials"></p>

<p><img src="images/google/download-service-creds.png" alt="Download Credentials"></p>

<ol>
<li>Save a JSON file with the application credentials. After downloading the credentials, the site will take you back to the credentials homepage and you will see a new service account key.</li>
</ol>

<p><img src="images/google/credentials-service.png" alt="Credentials Service Keys"></p>

<h2 class='everybody'>Step A3:  Create OAUTH2.0 Consent </h2>

<ol>
<li>Go to the ‘OAuth consent screen&#39; tab = you will need to give a &#39;product name&#39;  like &#39;Google Auth REST OAUTH2 service&#39; - a banner that is shown when consent to authorize a request is requested  (ie when we test it on the REST client in the main tutorial) and an email address, click ‘Save’.</li>
</ol>

<p>The OAuth consent screen is what the user (in the tutorial) will see when they are authenticating themselves against the Google Auth REST Service</p>

<p><img src="images/google/product-name.png" alt="Consent Name for Authentication"></p>

<h2 class='everybody'>Step A4:  Create OAuth2.0 Client ID credentials for the Credentials Service Account </h2>

<ol>
<li><p>Go back to the ‘Credentials’ tab and click the ‘Create Credentials’ dropdown and select ‘OAuth Client ID’.</p></li>
<li><p>Choose &#39;Web Application&#39; and give it a simple name like &#39;Web Client 1&#39;</p></li>
<li><p>Under the &#39;Authorised Javascript Origins&#39; section add a line with the following URI - this is the client application (the REST Server):</p>

<p><a href="http://localhost:3000">http://localhost:3000</a></p></li>
<li><p>We will need to add &#39;Authorized Redirect URIs&#39; at the bottom - this is where the authenticated session is redirected back to after getting consent from the Google+ OAUTH2.0 authentication service. The callback will match what we will configure in our Composer REST Server environment variables (specifically the variable <code>COMPOSER_PROVIDERS</code>, in the <code>envvars.txt</code> when performing this instruction in the main tutorial).</p></li>
</ol>

<p>Under &#39;Authorized Redirect URIs&#39; add the following URIs as authorised URIs. Note: it is best to copy/paste each URI below, then hit ENTER in the browser after each line entry- as the URI line editor can sometimes truncate your entry whilst typing .e.g. if you happen to pause when typing the URI.</p>
<div class="highlight"><pre><code class="language-" data-lang="">http://localhost:3000/auth/google
http://localhost:3000/auth/google/callback
</code></pre></div>
<p>Then click on the &#39;Create&#39; button at the bottom.</p>

<p><img src="images/google/create_client_id.png" alt="Create Client ID"></p>

<p>You will be prompted to save the Client ID and Client Secret - copy these two and save these for later.</p>

<p><img src="images/google/client-keys.png" alt="Client ID and Secret"></p>

<p>You&#39;re all set - you can now return to the main tutorial to set up your REST Server Authentication using Google&#39;s OAUTH2.0 client authentication service.</p>
  </body>
</html>
